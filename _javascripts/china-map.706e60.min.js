const commonChartOptions={tooltip:{trigger:'item',formatter:'{b}'},series:[{type:'map',roam:false,selectedMode:false,label:{show:false,},itemStyle:{normal:{areaColor:'#ccc',borderColor:'#fff',borderWidth:1},emphasis:{areaColor:'#999',label:{show:false}}}}]};function initEchartsMap({selector,mapName,jsonPath,seriesName,data,onClick}){document.addEventListener('DOMContentLoaded',()=>{const chartDom=document.querySelector(selector);if(!chartDom)return;const chart=echarts.init(chartDom);fetch(jsonPath).then(res=>res.json()).then(geoJson=>{echarts.registerMap(mapName,geoJson);const option={...commonChartOptions,series:[{...commonChartOptions.series[0],name:seriesName,map:mapName,data:data||[]}]};chart.setOption(option);if(onClick){chart.on('click',params=>{if(params.componentType==='series'&&params.seriesType==='map'){onClick(params.name);}});}}).catch(err=>console.error(`${seriesName}地图加载失败:`,err));});}
initEchartsMap({selector:'[data-echarts-map="china"]',mapName:'china',jsonPath:'/_javascripts/china.json',seriesName:'中国地图',data:[{name:'辽宁',itemStyle:{normal:{areaColor:'#1890ff'},emphasis:{areaColor:'#40a9ff'}}},{name:'四川',itemStyle:{normal:{areaColor:'#1890ff'},emphasis:{areaColor:'#40a9ff'}}},{name:'广东',itemStyle:{normal:{areaColor:'#1890ff'},emphasis:{areaColor:'#40a9ff'}}}],onClick:async(provinceName)=>{const contentContainer=document.getElementById('province-content');const provincePaths={'辽宁':'/liaoning.html','四川':'/sichuan.html','广东':'/guangdong.html'};const path=provincePaths[provinceName];if(path){try{contentContainer.innerHTML='<div class="loading">加载中...</div>';const response=await fetch(path);const html=await response.text();contentContainer.innerHTML=html;}catch(err){contentContainer.innerHTML=`<div class="error">加载${provinceName}内容失败: ${err.message}</div>`;}}else{contentContainer.innerHTML=`<div class="tip">暂未开放${provinceName}地图页面</div>`;}}});initEchartsMap({selector:'[data-echarts-map="sichuan"]',mapName:'sichuan',jsonPath:'/_javascripts/51.json',seriesName:'四川地图'});initEchartsMap({selector:'[data-echarts-map="guangdong"]',mapName:'guangdong',jsonPath:'/_javascripts/44.json',seriesName:'广东地图'});initEchartsMap({selector:'[data-echarts-map="liaoning"]',mapName:'liaoning',jsonPath:'/_javascripts/21.json',seriesName:'辽宁地图'});