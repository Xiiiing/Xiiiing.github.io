const commonChartOptions={tooltip:{trigger:'item',formatter:'{b}'},series:[{type:'map',roam:false,selectedMode:false,label:{show:false},itemStyle:{normal:{areaColor:'#ccc',borderColor:'#fff',borderWidth:1},emphasis:{areaColor:'#999',label:{show:false}}}}]};const provinceKeyMap={'辽宁':'liaoning','四川':'sichuan','广东':'guangdong'};function initEchartsMap({selector,mapName,jsonPath,seriesName,data}){document.addEventListener('DOMContentLoaded',()=>{const chartDom=document.querySelector(selector);if(!chartDom)return;const chart=echarts.init(chartDom);fetch(jsonPath).then(res=>res.json()).then(geoJson=>{echarts.registerMap(mapName,geoJson);const option={...commonChartOptions,series:[{...commonChartOptions.series[0],name:seriesName,map:mapName,data:data||[]}]};chart.setOption(option);if(mapName==='china'){chart.on('click',params=>{const provinceName=params.name;const targetKey=provinceKeyMap[provinceName];if(targetKey){document.querySelector('[data-echarts-map="china"]').style.display='none';document.querySelector(`[data-echarts-map="${targetKey}"]`).style.display='block';}});}
const backButtons=chartDom.querySelectorAll('.back-button');backButtons.forEach(btn=>{btn.addEventListener('click',()=>{const targetMap=btn.dataset.target;chartDom.style.display='none';document.querySelector(`[data-echarts-map="${targetMap}"]`).style.display='block';});});}).catch(err=>console.error(`${seriesName}地图加载失败:`,err));});}
initEchartsMap({selector:'[data-echarts-map="china"]',mapName:'china',jsonPath:'/_javascripts/china.json',seriesName:'中国地图',data:[{name:'辽宁',itemStyle:{normal:{areaColor:'#1890ff'},emphasis:{areaColor:'#40a9ff'}}},{name:'四川',itemStyle:{normal:{areaColor:'#1890ff'},emphasis:{areaColor:'#40a9ff'}}},{name:'广东',itemStyle:{normal:{areaColor:'#1890ff'},emphasis:{areaColor:'#40a9ff'}}}]});initEchartsMap({selector:'[data-echarts-map="sichuan"]',mapName:'sichuan',jsonPath:'/_javascripts/51.json',seriesName:'四川地图'});initEchartsMap({selector:'[data-echarts-map="guangdong"]',mapName:'guangdong',jsonPath:'/_javascripts/44.json',seriesName:'广东地图'});initEchartsMap({selector:'[data-echarts-map="liaoning"]',mapName:'liaoning',jsonPath:'/_javascripts/21.json',seriesName:'辽宁地图'});